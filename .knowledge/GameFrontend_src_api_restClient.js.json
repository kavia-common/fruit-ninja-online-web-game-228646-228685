{"is_source_file": true, "format": "JavaScript", "description": "This file defines a REST API client for a front-end application of a game (Fruit Ninja Online). It includes functions to perform health checks, retrieve and submit scores, get and update user profiles, and handles network errors, retries, and mock data fallback for offline scenarios.", "external_files": [], "external_methods": ["fetch"], "published": ["createRestApiClient", "health", "getTopScores", "submitScore", "getProfile", "updateProfile", "apiClient", "healthCheck", "getTopScores", "submitScore", "getProfile", "updateProfile"], "classes": [], "methods": [{"name": "safeTrim(s)", "description": "Trims whitespace from a string if input is a string.", "scope": "", "scopeKind": ""}, {"name": "joinUrl(baseUrl, path)", "description": "Concatenates base URL and path, ensuring proper slash handling.", "scope": "", "scopeKind": ""}, {"name": "getApiBaseUrlFromEnv()", "description": "Determines the API base URL from environment variables, with fallback.", "scope": "", "scopeKind": ""}, {"name": "resolveHealthPath()", "description": "Provides the health check path, defaulting to '/health'.", "scope": "", "scopeKind": ""}, {"name": "isProbablyJsonResponse(contentType)", "description": "Checks if the content type header indicates a JSON response.", "scope": "", "scopeKind": ""}, {"name": "makeApiError(partial)", "description": "Constructs a standardized ApiError object based on input parameters.", "scope": "", "scopeKind": ""}, {"name": "sleep(ms)", "description": "Asynchronous delay function.", "scope": "", "scopeKind": ""}, {"name": "fetchWithTimeout(fetchImpl, url, options, timeoutMs)", "description": "Fetch wrapper that aborts if response takes longer than specified timeout.", "scope": "", "scopeKind": ""}, {"name": "parseResponseBody(res)", "description": "Parses fetch response as JSON or text, with error handling.", "scope": "", "scopeKind": ""}, {"name": "requestJson(fetchImpl, path, options = {})", "description": "Performs HTTP requests with retries, error handling, and supports mock mode when offline.", "scope": "", "scopeKind": ""}, {"name": "makeMockScores()", "description": "Generates mock leaderboard scores for offline fallback.", "scope": "", "scopeKind": ""}, {"name": "makeMockProfile()", "description": "Creates a mock user profile for offline mode.", "scope": "", "scopeKind": ""}, {"name": "normalizeScoresPayload(data)", "description": "Normalizes score data received from API or mock data to a consistent shape.", "scope": "", "scopeKind": ""}, {"name": "buildHighLevelApi(_requestJson)", "description": "Constructs an API client with methods: health, getTopScores, submitScore, getProfile, updateProfile, getBaseUrl.", "scope": "", "scopeKind": ""}, {"name": "createRestApiClient({ fetchImpl } = {})", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "getProfile()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "getTopScores()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "healthCheck()", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "submitScore(payload)", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "updateProfile(payload)", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["getApiBaseUrlFromEnv()", "joinUrl()", "requestJson()", "normalizeScoresPayload()", "makeMockScores()", "makeMockProfile()"], "search-terms": ["restClient", "API client", "score submission", "profile get/update", "health check", "offline fallback", "mock data", "retry", "fetch wrapper"], "state": 2, "file_id": 22, "knowledge_revision": 61, "git_revision": "3f1ec58dc3be5213b2634462a10e2c1953f01081", "revision_history": [{"59": "3f1ec58dc3be5213b2634462a10e2c1953f01081"}, {"61": "3f1ec58dc3be5213b2634462a10e2c1953f01081"}], "ctags": [{"_type": "tag", "name": "Accept", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    Accept: \"application\\/json\",$/", "language": "JavaScript", "kind": "property", "scope": "requestJson.headers", "scopeKind": "class"}, {"_type": "tag", "name": "DEFAULT_GET_RETRIES", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^const DEFAULT_GET_RETRIES = 2;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "DEFAULT_TIMEOUT_MS", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^const DEFAULT_TIMEOUT_MS = 6500;$/", "language": "JavaScript", "kind": "constant"}, {"_type": "tag", "name": "buildHighLevelApi", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function buildHighLevelApi(_requestJson) {$/", "language": "JavaScript", "kind": "function", "signature": "(_requestJson)"}, {"_type": "tag", "name": "createRestApiClient", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^export function createRestApiClient({ fetchImpl } = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "({ fetchImpl } = {})"}, {"_type": "tag", "name": "details", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    details: partial?.details ?? null$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "err", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^  const err = {$/", "language": "JavaScript", "kind": "class", "scope": "makeApiError", "scopeKind": "class"}, {"_type": "tag", "name": "fetchWithTimeout", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^async function fetchWithTimeout(fetchImpl, url, options, timeoutMs) {$/", "language": "JavaScript", "kind": "function", "signature": "(fetchImpl, url, options, timeoutMs)"}, {"_type": "tag", "name": "getApiBaseUrlFromEnv", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function getApiBaseUrlFromEnv() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getProfile", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^export function getProfile() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "getTopScores", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^export function getTopScores() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "headers", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^  const headers = {$/", "language": "JavaScript", "kind": "class", "scope": "requestJson", "scopeKind": "class"}, {"_type": "tag", "name": "healthCheck", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^export function healthCheck() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "isMock", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    isMock: Boolean(partial?.isMock),$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "isNetwork", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    isNetwork: Boolean(partial?.isNetwork),$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "isProbablyJsonResponse", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function isProbablyJsonResponse(contentType) {$/", "language": "JavaScript", "kind": "function", "signature": "(contentType)"}, {"_type": "tag", "name": "isTimeout", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    isTimeout: Boolean(partial?.isTimeout),$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "joinUrl", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function joinUrl(baseUrl, path) {$/", "language": "JavaScript", "kind": "function", "signature": "(baseUrl, path)"}, {"_type": "tag", "name": "makeApiError", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function makeApiError(partial) {$/", "language": "JavaScript", "kind": "function", "signature": "(partial)"}, {"_type": "tag", "name": "makeMockProfile", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function makeMockProfile() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "makeMockScores", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function makeMockScores() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "message", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    message: partial?.message || \"Request failed\",$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "method", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    method: typeof partial?.method === \"string\" ? partial.method : null,$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^        name: safeTrim(payload?.name) || \"Anonymous\",$/", "language": "JavaScript", "kind": "property", "scope": "buildHighLevelApi.safePayload", "scopeKind": "class"}, {"_type": "tag", "name": "name", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    name: partial?.name || \"ApiError\",$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "normalizeScoresPayload", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function normalizeScoresPayload(data) {$/", "language": "JavaScript", "kind": "function", "signature": "(data)"}, {"_type": "tag", "name": "ok", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    ok: false,$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "parseResponseBody", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^async function parseResponseBody(res) {$/", "language": "JavaScript", "kind": "function", "signature": "(res)"}, {"_type": "tag", "name": "requestJson", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^async function requestJson(fetchImpl, path, options = {}) {$/", "language": "JavaScript", "kind": "function", "signature": "(fetchImpl, path, options = {})"}, {"_type": "tag", "name": "resolveHealthPath", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function resolveHealthPath() {$/", "language": "JavaScript", "kind": "function", "signature": "()"}, {"_type": "tag", "name": "safePayload", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^      const safePayload = {$/", "language": "JavaScript", "kind": "class", "scope": "buildHighLevelApi", "scopeKind": "class"}, {"_type": "tag", "name": "safeTrim", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^function safeTrim(s) {$/", "language": "JavaScript", "kind": "function", "signature": "(s)"}, {"_type": "tag", "name": "score", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^        score: Number.isFinite(payload?.score) ? payload.score : 0$/", "language": "JavaScript", "kind": "property", "scope": "buildHighLevelApi.safePayload", "scopeKind": "class"}, {"_type": "tag", "name": "sleep", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^async function sleep(ms) {$/", "language": "JavaScript", "kind": "function", "signature": "(ms)"}, {"_type": "tag", "name": "status", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    status: typeof partial?.status === \"number\" ? partial.status : null,$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}, {"_type": "tag", "name": "submitScore", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^export function submitScore(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "updateProfile", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^export function updateProfile(payload) {$/", "language": "JavaScript", "kind": "function", "signature": "(payload)"}, {"_type": "tag", "name": "url", "path": "/home/kavia/workspace/code-generation/fruit-ninja-online-web-game-228646-228685/GameFrontend/src/api/restClient.js", "pattern": "/^    url: typeof partial?.url === \"string\" ? partial.url : null,$/", "language": "JavaScript", "kind": "property", "scope": "makeApiError.err", "scopeKind": "class"}], "hash": "4101971b15c4f14d5d832bdf5037a814", "format-version": 4, "code-base-name": "GameFrontend", "filename": "GameFrontend/src/api/restClient.js", "fields": [{"name": "Accept: \"application\\/json\",", "scope": "requestJson.headers", "scopeKind": "class", "description": "unavailable"}, {"name": "details: partial?.details ?? null", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "isMock: Boolean(partial?.isMock),", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "isNetwork: Boolean(partial?.isNetwork),", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "isTimeout: Boolean(partial?.isTimeout),", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "message: partial?.message || \"Request failed\",", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "method: typeof partial?.method === \"string\" ? partial.method : null,", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "name: safeTrim(payload?.name) || \"Anonymous\",", "scope": "buildHighLevelApi.safePayload", "scopeKind": "class", "description": "unavailable"}, {"name": "name: partial?.name || \"ApiError\",", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "ok: false,", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "score: Number.isFinite(payload?.score) ? payload.score : 0", "scope": "buildHighLevelApi.safePayload", "scopeKind": "class", "description": "unavailable"}, {"name": "status: typeof partial?.status === \"number\" ? partial.status : null,", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}, {"name": "url: typeof partial?.url === \"string\" ? partial.url : null,", "scope": "makeApiError.err", "scopeKind": "class", "description": "unavailable"}]}